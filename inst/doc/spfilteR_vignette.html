<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Sebastian Juhl" />

<meta name="date" content="2021-08-13" />

<title>spfilteR: Spatial Filtering with Eigenvectors</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">spfilteR: Spatial Filtering with
Eigenvectors</h1>
<h4 class="author">Sebastian Juhl</h4>
<h4 class="date">2021-08-13</h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>The <code>spfilteR</code> package provides tools to implement the
eigenvector-based spatial filtering (ESF) approach put forth by <span class="citation">Griffith (2003)</span> in linear and generalized linear
regression models. It allows users to obtain eigenvectors from a
transformed connectivity matrix and supports the supervised and
unsupervised creation of a synthetic spatial filter. For the
unsupervised approach, eigenvectors can be selected based on either i)
the maximization of model fit, ii) the minimization of residual
autocorrelation, iii) the statistical significance of residual
autocorrelation, or iv) the significance level of candidate
eigenvectors. Alternatively, all eigenvectors in the search set may be
included so that no selection takes place. While the functions provide a
high flexibility, only a minimum of code is required to implement the
unsupervised ESF approach.</p>
<p>This vignette solely focuses on the workflow to illustrate the
functionality of the <code>spfilteR</code> package. For a discussion on
the ESF methodology, interested readers may be referred to other
sources, e.g., <span class="citation">Griffith, Chun, and Li
(2019)</span> or <span class="citation">Tiefelsdorf and Griffith
(2007)</span>.</p>
</div>
<div id="installation" class="section level2">
<h2>Installation</h2>
<p>A stable release version of the <code>spfilteR</code> package is
available on CRAN and the latest development version can be downloaded
from <a href="https://github.com/sjuhl/spfilteR">GitHub</a>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># CRAN release</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;spfilteR&quot;</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co"># GitHub</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">library</span>(devtools)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;sjuhl/spfilteR&quot;</span>)</span></code></pre></div>
<p>spfilteR_vignette.R</p>
</div>
<div id="getting-started" class="section level2">
<h2>Getting Started</h2>
<p>Together with the main functions, the package contains an artificial
dataset (<code>fakedataset</code>) and a connectivity matrix
(<code>W</code>) connecting the 100 cross-sections on a regular grid by
using the rook criterion of adjacency. For illustrative purposes, the
following examples utilize the fake dataset.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># load the package</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">library</span>(spfilteR)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co"># load the dataset</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;fakedata&quot;</span>)</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co"># take a look at the connectivity matrix and the variables</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="fu">dim</span>(W)</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="co">#&gt; [1] 100 100</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="fu">head</span>(fakedataset)</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="co">#&gt;   ID indicator count       x1        x2         x3  negative negcount</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="co">#&gt; 1  1         0     0 11.29514  5.527426  6.6406409 -2.338103        9</span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="co">#&gt; 2  2         0     4 13.92705  7.047870  4.0049350 -2.048737        3</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="co">#&gt; 3  3         1     1 17.31431 10.525834 -0.7022595 -1.868379        5</span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="co">#&gt; 4  4         1     4 15.21778  7.817901  1.5948141 -2.737914        2</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="co">#&gt; 5  5         1     3 15.56298  7.903947 -1.2708973 -1.117427        2</span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="co">#&gt; 6  6         1     2 17.43941 11.254842 -1.4158475  1.577442        2</span></span></code></pre></div>
<p>spfilteR_vignette.R</p>
<p>Besides an <code>ID</code> variable, the dataset contains a binary
<code>indicator</code> variable, two count variables, and four
continuous variables.</p>
<div id="identifying-spatial-autocorrelation" class="section level3">
<h3>Identifying Spatial Autocorrelation</h3>
<p>In a first step, the function <code>MI.vec()</code> checks for the
presence of spatial autocorrelation in the continuous variables by means
of Moran’s <em>I</em> <span class="citation">(see also Cliff and Ord
1981, 1972)</span>. The function further allows users to define the
alternative hypothesis in order to obtain <em>p</em>-values.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># select continuous variables</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>cont <span class="ot">&lt;-</span> <span class="fu">cbind</span>(fakedataset<span class="sc">$</span>x1, fakedataset<span class="sc">$</span>x2, fakedataset<span class="sc">$</span>x3, fakedataset<span class="sc">$</span>negative)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="fu">colnames</span>(cont) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;x1&quot;</span>, <span class="st">&quot;x2&quot;</span>, <span class="st">&quot;x3&quot;</span>, <span class="st">&quot;negative&quot;</span>)</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co"># Moran test of spatial autocorrelation</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>(I <span class="ot">&lt;-</span> <span class="fu">MI.vec</span>(<span class="at">x =</span> cont, <span class="at">W =</span> W, <span class="at">alternative =</span> <span class="st">&#39;greater&#39;</span>))</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt;                     I          EI        VarI         zI           pI    </span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co">#&gt; x1        0.311178214 -0.01010101 0.005344193  4.3948248 5.543107e-06 ***</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co">#&gt; x2        0.168757531 -0.01010101 0.005344193  2.4466317 7.209904e-03  **</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co">#&gt; x3        0.009112739 -0.01010101 0.005344193  0.2628276 3.963417e-01    </span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co">#&gt; negative -0.244064424 -0.01010101 0.005344193 -3.2004192 9.993139e-01</span></span></code></pre></div>
<p>spfilteR_vignette.R</p>
<p>The output suggests that the variables <code>x1</code> and
<code>x2</code> are positively autocorrelated at conventional levels of
statistical significance. Moreover, the standardized value of Moran’s
<em>I</em> (<code>zI</code>) indicates that the variable
<code>negative</code> is negatively autocorrelated. We can use the
function <code>MI.vec()</code> and specify
<code>alternative = &#39;lower&#39;</code> to assess the significance of the
negative autocorrelation:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">MI.vec</span>(<span class="at">x =</span> fakedataset<span class="sc">$</span>negative, <span class="at">W =</span> W, <span class="at">alternative =</span> <span class="st">&#39;lower&#39;</span>)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co">#&gt;            I          EI        VarI        zI           pI    </span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">#&gt; 1 -0.2440644 -0.01010101 0.005344193 -3.200419 0.0006861391 ***</span></span></code></pre></div>
<p>spfilteR_vignette.R</p>
<p>Since the Moran coefficient is a global measure of spatial
autocorrelation, spatial heterogeneity constitutes a problem for this
statistic. More specifically, the simultaneous presence of positive and
negative spatial autocorrelation at different scales cannot be revealed
by the classical Moran’s <em>I</em>. To circumvent this problem, the
function <code>MI.decomp()</code> decomposes the Moran coefficient into
a positively and a negatively autocorrelated part and performs a
permutation procedure to assess the significance <span class="citation">(Dray 2011)</span>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># decompose Moran&#39;s I</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>(I.dec <span class="ot">&lt;-</span> <span class="fu">MI.decomp</span>(<span class="at">x =</span> cont, <span class="at">W =</span> W, <span class="at">nsim=</span><span class="dv">100</span>))</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">#&gt;                 I+       VarI+        pI+            I-       VarI-        pI-</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt; x1       0.3894789 0.001757946 0.00990099 ** -0.0783007 0.002055672 1.00000000</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">#&gt; x2       0.3048369 0.001816208 0.02970297  * -0.1360794 0.001825816 0.99009901</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#&gt; x3       0.2247566 0.002026051 0.25742574    -0.2156438 0.002566824 0.50495050</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt; negative 0.1131614 0.002063477 1.00000000    -0.3572259 0.001791260 0.01980198</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="co">#&gt;            pItwo.sided  </span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co">#&gt; x1          0.01980198 *</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co">#&gt; x2          0.05940594 .</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="co">#&gt; x3          0.51485149  </span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="co">#&gt; negative *  0.03960396 *</span></span></code></pre></div>
<p>spfilteR_vignette.R</p>
<p>Note that the global Moran’s <em>I</em> is the sum of <code>I+</code>
and <code>I-</code>:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># I = &#39;I+&#39; + &#39;I-&#39;</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">cbind</span>(I[, <span class="st">&quot;I&quot;</span>], I.dec[, <span class="st">&quot;I+&quot;</span>] <span class="sc">+</span> I.dec[, <span class="st">&quot;I-&quot;</span>])</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co">#&gt;              [,1]         [,2]</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co">#&gt; [1,]  0.311178214  0.311178214</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="co">#&gt; [2,]  0.168757531  0.168757531</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co">#&gt; [3,]  0.009112739  0.009112739</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co">#&gt; [4,] -0.244064424 -0.244064424</span></span></code></pre></div>
<p>spfilteR_vignette.R</p>
</div>
<div id="unsupervised-spatial-filtering-in-linear-models" class="section level3">
<h3>Unsupervised Spatial Filtering in Linear Models</h3>
<p>Assume that we wish to regress <code>x1</code> on <code>x2</code> and
test for residual autocorrelation using the function
<code>MI.resid()</code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># define variables</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> fakedataset<span class="sc">$</span>x1</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="dv">1</span>, fakedataset<span class="sc">$</span>x2)</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co"># OLS regression</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>ols.resid <span class="ot">&lt;-</span> <span class="fu">resid</span>(<span class="fu">lm</span>(y <span class="sc">~</span> X))</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co"># Moran test of residual spatial autocorrelation</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="fu">MI.resid</span>(<span class="at">resid =</span> ols.resid, <span class="at">W =</span> W, <span class="at">alternative =</span> <span class="st">&#39;greater&#39;</span>)</span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co">#&gt;          I          EI        VarI       zI           pI    </span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="co">#&gt; 1 0.350568 -0.01010101 0.005344193 4.933643 4.035495e-07 ***</span></span></code></pre></div>
<p>spfilteR_vignette.R</p>
<p>The results show that the residuals are significantly autocorrelated
which violates the assumption of uncorrelated errors. In order to
resolve this problem of spatial autocorrelation in regression residuals,
the function <code>lmFilter()</code> estimates a spatially filtered
linear regression model using an unsupervised stepwise regression to
identify relevant eigenvectors derived from the transformed connectivity
matrix. Below, the unsupervised eigenvector search algorithm selects
eigenvectors based on the reduction in residual autocorrelation. The
output is a class <code>spfilter</code> object.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># ESF model</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>(lm.esf <span class="ot">&lt;-</span> <span class="fu">lmFilter</span>(<span class="at">y =</span> y, <span class="at">x =</span> X, <span class="at">W =</span> W, <span class="at">objfn =</span> <span class="st">&#39;MI&#39;</span>, <span class="at">positive =</span> <span class="cn">TRUE</span>,</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>                    <span class="at">ideal.setsize =</span> <span class="cn">TRUE</span>, <span class="at">tol =</span> .<span class="dv">2</span>))</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co">#&gt; 8 out of 22 candidate eigenvectors selected</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="fu">summary</span>(lm.esf, <span class="at">EV =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co">#&gt;  - Spatial Filtering with Eigenvectors (Linear Model)  -</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co">#&gt; Coefficients (OLS):</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="co">#&gt;             Estimate         SE      p-value    </span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co">#&gt; (Intercept) 9.157300 0.66498789 7.085512e-24 ***</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="co">#&gt; beta_1      1.002048 0.07987266 1.810387e-21 ***</span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a><span class="co">#&gt; Adjusted R-squared:</span></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a><span class="co">#&gt;   Initial  Filtered </span></span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a><span class="co">#&gt; 0.4673945 0.7269254 </span></span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a><span class="co">#&gt; Filtered for positive spatial autocorrelation</span></span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a><span class="co">#&gt; 8 out of 22 candidate eigenvectors selected</span></span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a><span class="co">#&gt; Objective Function: &quot;MI&quot;</span></span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a><span class="co">#&gt; Summary of selected eigenvectors:</span></span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a><span class="co">#&gt;        Estimate       SE      p-value  partialR2      VIF        MI    </span></span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a><span class="co">#&gt; ev_13 -9.591223 1.444445 2.311889e-09 0.23208263 1.005781 0.6302019 ***</span></span>
<span id="cb8-26"><a href="#cb8-26" tabindex="-1"></a><span class="co">#&gt; ev_4  -3.208445 1.477942 3.257137e-02 0.02873360 1.049729 0.9257835   *</span></span>
<span id="cb8-27"><a href="#cb8-27" tabindex="-1"></a><span class="co">#&gt; ev_10 -5.513538 1.450486 2.616676e-04 0.07901543 1.013360 0.7303271 ***</span></span>
<span id="cb8-28"><a href="#cb8-28" tabindex="-1"></a><span class="co">#&gt; ev_2   4.783331 1.440553 1.299155e-03 0.05809724 1.000973 1.0004147  **</span></span>
<span id="cb8-29"><a href="#cb8-29" tabindex="-1"></a><span class="co">#&gt; ev_20 -4.483968 1.443887 2.540511e-03 0.05037486 1.005087 0.4539879  **</span></span>
<span id="cb8-30"><a href="#cb8-30" tabindex="-1"></a><span class="co">#&gt; ev_9   3.375359 1.466975 2.370749e-02 0.02850944 1.034811 0.7638378   *</span></span>
<span id="cb8-31"><a href="#cb8-31" tabindex="-1"></a><span class="co">#&gt; ev_5  -2.879124 1.449331 5.001742e-02 0.02055372 1.011899 0.8968632   .</span></span>
<span id="cb8-32"><a href="#cb8-32" tabindex="-1"></a><span class="co">#&gt; ev_19  3.801456 1.440410 9.795035e-03 0.03671349 1.000798 0.4615722  **</span></span>
<span id="cb8-33"><a href="#cb8-33" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-34"><a href="#cb8-34" tabindex="-1"></a><span class="co">#&gt; Moran&#39;s I ( Residuals):</span></span>
<span id="cb8-35"><a href="#cb8-35" tabindex="-1"></a><span class="co">#&gt;             Observed    Expected   Variance         z      p-value    </span></span>
<span id="cb8-36"><a href="#cb8-36" tabindex="-1"></a><span class="co">#&gt; Initial   0.35056797 -0.01192610 0.01207299 3.2990854 0.0004850019 ***</span></span>
<span id="cb8-37"><a href="#cb8-37" tabindex="-1"></a><span class="co">#&gt; Filtered -0.03391298 -0.07716011 0.04881644 0.1957376 0.4224077749</span></span></code></pre></div>
<p>spfilteR_vignette.R</p>
<p>While the <code>print</code> method shows that 8 eigenvectors were
selected from the candidate set consisting of 22 eigenvectors, the
<code>summary</code> method provides additional information. Besides the
ordinary least squares (OLS) parameter estimates, the output shows that
the ESF model filters for positive spatial autocorrelation using the
minimization of residual autocorrelation as objective function during
the eigenvector search. A comparison between the filtered and the
nonspatial OLS model with respect to model fit and residual
autocorrelation is also provided. Since the option <code>EV</code> is
set to <code>TRUE</code>, the <code>summary</code> method also displays
information on the selected eigenvectors. As the results show, the ESF
model successfully removes the spatial pattern from model residuals.</p>
<p>The <code>plot</code> method allows for an easy visualization of the
results. The graph displays the Moran coefficient associated with each
of the eigenvectors. The shaded area signifies the candidate set and
selected eigenvectors are illustrated by black dots.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">plot</span>(lm.esf)</span></code></pre></div>
<p><img src="data:image/png;base64,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WWed5QYMGBD35YcffnDDhw93Xbt2dUsttZQ76qij3FVXXeX69u0bl2EDqQIG99Of/tRtsMEGbuLEifFxpj3du3d3b7zxhttmm23cIoss4tZee213++23S5nvvvvO9ezZ011zzTXxOWx8/PHHbr311nP333+/7P/nP//pBg0a5FZYYQW3xBJLuF122cW98847Oed8+eWXbvDgwa5z585ulVVWccOGDXPvvfee++qrr9yGG24oZU8//XSnjPZf//qXGzVqlFtjjTXivmu/tGKkpb/85S9uo402ciuvvLK755579JD9VoqAfyMYNTkCn376Ka/9aOTIkQVHetBBB0WekcTlzjjjjGj++eeP/vCHP0S33npr5Kcw0YILLhh16dIlLnP++edHc801V+SZUnTbbbdFnklFXtcUTZgwQcrce++98n/FFVeMPHOLPAOLPJOSfTNnzpQyu+++u+yLK/Ubl112mbT9+eefR54RRp6BRIsvvnh04oknSl88Y4h+8YtfRIwP8swk2nHHHaNf/epXkWeI0dVXXx15hhHtvPPO0Zw5c+Q/OBxwwAGRZ5ByzkknnRTNPffcEb933nlnxPgpM3bsWDnO1wILLBD5aWnkp6fR9ttvH02fPj0+ZhuVIYBIatTkCCgD4kGbb7752ny89BEjEDKgDz74QBjLqaeeGh/3Uog89Guuuabs++yzz6KFF1448hJFXIYNGIqXQGQfDIiHesSIEXEZL7nIviuuuEL28fBT5u23347LbL755sLU2HHzzTfL8bvuuis+Tl9gDjAkyEsuUubZZ5+Ny0ydOlUY5quvvhp5SUuOX3vttXL83XffjeaZZ57IS31xeTb22muv6Je//KWU5z9teAlQGBz/jbJDwHRA/q5vFerdu7dMdZLjXXrppZO75P/zzz/vmKJwnpJ/GJ2XMhzTKogy//jHP9z666/v/IOvxWRK4yUm9/e//z3e5xlKvL3sssu6n/zkJ+6LL76Qfdttt51bbLHFHOcMHTrUffjhh+7hhx92d9xxhxx/5JFHnGd0MvUK21lnnXXc448/LmVeeOEF56UsmQpqQ1tssYW0gfXPS0G6W37pO/vCKScHBg4c6G644Qb35ptvutVXX13KMkX88Y9NYyFgZPhlDChDMOu9qi233NINGTKk6G56qUEeOnQ6IaELUvISi2weccQRuivnV4+zE71NSPPOO68wOPZ5ScTtscce7pZbbhEGNH78ePfzn//cbbvttnIK9cDo0CUlqVOnTrLrlVdeET1V8jjMJ43eeustcUtIMmA/hZPi6I6UAcEwjbJHwFh69pg2TY1e3+JQQquUogMLpRqYBPToo486lMTJD4pppXyMQI/vvffe7umnn3azZs0SRgRDgjFBKK5hNCiZk228/PLLUgYJCSaVJJTZftKQ3C0SF/v9NDLn2CeffCL/kaaU/PRVN+03QwSMAWUIZrNVheQD0/A6nHhoTMmmTJkS/8faBGElYnqmHySZQw89tM20Jz4xZQMfHSxcWNSYVuG3pOR1Tg4pCGajbXjluFi8sMpBSCtY2pSBsO/11193Sy65pJs8ebKMhX0wVQjLF/TQQw/Jr37xf6GFFhKGp/vst0oIZKdOsprqFQFVQvsHOho3blzqZ8aMGdL9UAnNjj333FOUzCh6sWphBfNMKccKhsLZ62+i0aNHi0Xqvvvui7w5PjrhhBOkTlVC+ymP/Nevn/3sZ9G5556rf+UXa5TXDUWeEYnlSw96phJ5aSvypvDIM5PIS2ERynGvl4m81CTFUIjTDz/VjP76179GnhlFffr0ibx+SqsRBTyWOK//kX1+ihd5ySp64oknom+++UYsYfTL66HiczzDiy644IL4v21kh4BZwbLDsm5rUgbk32FiBUr7VUtQkgHxUGJWX3755cX65f1wxEoUPtR+qUfkFbdizqZuryMSc7b3vRFMSmFAWKuoQy1bIajPPPOMWKM4DhPEXeDyyy8Pi0R+SUmEhU7HiCWOfUpHH3209NPro2SXn55Fv/3tb4WRUSdm/eOOO06Ly68xoBw4Mv3zI2rzF8vIEGiDALofFNE4IaouhkI77bSTKI8nTZqUcw4OhShuvUQRT3dyCmT0h7Vt3377rfOm8rw1ovfxzNOhUGYaGdLXX38t0zDvzxTvZh+WN6aARh2HgOmAOg7rhmsJfQ/ew6eddlpsrUKXAuNJW1OGVYsHOPnAZz1wFN/tMR/aw+KG5SqtL+iOQuZDefYZ8wGJjiWTgDoW74Zr7aKLLnJnnnmmKJPx20GyYDnGhRde2HBjsQ7XHwLGgOrvmtRdj7AaPffcc46pD5YxzN1GhkAWCBgDygJFq8MQMATKQsB0QGXBZicZAoZAFggYA8oCRavDEDAEykLAGFBZsNlJhoAhkAUCxoCyQNHqMAQMgbIQMAZUFmx2kiFgCGSBgDGgLFC0OgwBQ6AsBIwBlQWbnWQIGAJZIGAMKAsUrQ5DwBAoCwFjQGXBZicZAoZAFggYA8oCRavDEDAEykLAGFBZsNlJhoAhkAUCxoCyQNHqMAQMgbIQMAZUFmx2kiFgCGSBgDGgLFC0OgwBQ6AsBIwBlQWbnWQIGAJZIGAMKAsUrQ5DwBAoCwFjQGXBZicZAoZAFggYA8oCRavDEDAEykLAGFBZsNlJhoAhkAUC/w+St/BELnCiwgAAAABJRU5ErkJggg==" width="50%" style="display: block; margin: auto;" />spfilteR_vignette.R</p>
<p>Moreover, <code>lmFilter()</code> also allows users to select
eigenvectors based on alternative selection criteria:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="do">### Alternative selection criteria:</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="co"># maximization of model fit</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="fu">lmFilter</span>(<span class="at">y =</span> y, <span class="at">x =</span> X, <span class="at">W =</span> W, <span class="at">objfn =</span> <span class="st">&#39;R2&#39;</span>, <span class="at">positive =</span> <span class="cn">TRUE</span>, <span class="at">ideal.setsize =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="co">#&gt; 10 out of 22 candidate eigenvectors selected</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="co"># significance of residual autocorrelation</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="fu">lmFilter</span>(<span class="at">y =</span> y, <span class="at">x =</span> X, <span class="at">W =</span> W, <span class="at">objfn =</span> <span class="st">&#39;pMI&#39;</span>, <span class="at">sig =</span> .<span class="dv">1</span>, <span class="at">bonferroni =</span> <span class="cn">FALSE</span>,</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>         <span class="at">positive =</span> <span class="cn">TRUE</span>, <span class="at">ideal.setsize =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="co">#&gt; 3 out of 22 candidate eigenvectors selected</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a><span class="co"># significance of eigenvectors</span></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a><span class="fu">lmFilter</span>(<span class="at">y =</span> y, <span class="at">x =</span> X, <span class="at">W =</span> W, <span class="at">objfn =</span> <span class="st">&#39;p&#39;</span>, <span class="at">sig =</span> .<span class="dv">1</span>, <span class="at">bonferroni =</span> <span class="cn">TRUE</span>,</span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a>         <span class="at">positive =</span> <span class="cn">TRUE</span>, <span class="at">ideal.setsize =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a><span class="co">#&gt; 3 out of 22 candidate eigenvectors selected</span></span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a></span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a><span class="co"># all eigenvectors in the candidate set</span></span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a><span class="fu">lmFilter</span>(<span class="at">y =</span> y, <span class="at">x =</span> X, <span class="at">W =</span> W, <span class="at">objfn =</span> <span class="st">&#39;all&#39;</span>, <span class="at">positive =</span> <span class="cn">TRUE</span>, <span class="at">ideal.setsize =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a><span class="co">#&gt; 22 out of 22 candidate eigenvectors selected</span></span></code></pre></div>
<p>spfilteR_vignette.R</p>
<p>If users wish to select eigenvectors based on individual selection
criteria, they can obtain the eigenvectors using the function
<code>getEVs()</code> and perform a supervised selection procedure using
the basic <a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/lm"><code>stats::lm()</code></a>
command.</p>
</div>
<div id="extension-to-generalized-linear-models" class="section level3">
<h3>Extension to Generalized Linear Models</h3>
<p>The ESF approach outlined above easily extends to generalized linear
models (GLMs) as well <span class="citation">(see also Griffith, Chun,
and Li 2019)</span>. Therefore, the <code>spfilteR</code> package
contains the function <code>glmFilter()</code> which uses maximum
likelihood estimation (MLE) to fit a spatially filtered GLM and performs
an unsupervised eigenvector search based on alternative objective
functions.</p>
<p>Except for minor differences, <code>glmFilter()</code> works similar
to the <code>lmFilter()</code> function discussed above. The option
<code>model</code> defines the model that needs to be estimated.
Currently, unsupervised spatial filtering is possible for logit, probit,
poisson, and negative binomial models. Moreover, the option
<code>optim.method</code> specifies the optimization method used to
maximize the log-likelihood function. Finally, <code>resid.type</code>
allows users to define the type of residuals used to calculate Moran’s
<em>I</em> and <code>boot.MI</code> is an integer specifying the number
of bootstrap permutations to obtain the variance of Moran’s
<em>I</em>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># define outcome variables</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>y.bin <span class="ot">&lt;-</span> fakedataset<span class="sc">$</span>indicator</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>y.count <span class="ot">&lt;-</span> fakedataset<span class="sc">$</span>count</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="co"># ESF logit model</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>(logit.esf <span class="ot">&lt;-</span> <span class="fu">glmFilter</span>(<span class="at">y =</span> y.bin, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">W =</span> W, <span class="at">objfn =</span> <span class="st">&#39;p&#39;</span>, <span class="at">model =</span> <span class="st">&#39;logit&#39;</span>,</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>                        <span class="at">optim.method =</span> <span class="st">&#39;BFGS&#39;</span>, <span class="at">sig =</span> .<span class="dv">1</span>, <span class="at">bonferroni =</span> <span class="cn">FALSE</span>,</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>                        <span class="at">positive =</span> <span class="cn">TRUE</span>, <span class="at">ideal.setsize =</span> <span class="cn">FALSE</span>, <span class="at">alpha =</span> .<span class="dv">25</span>,</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>                        <span class="at">resid.type =</span> <span class="st">&#39;deviance&#39;</span>, <span class="at">boot.MI =</span> <span class="dv">100</span>))</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="co">#&gt; 5 out of 31 candidate eigenvectors selected</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="co"># ESF probit model</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a>(probit.esf <span class="ot">&lt;-</span> <span class="fu">glmFilter</span>(<span class="at">y =</span> y.bin, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">W =</span> W, <span class="at">objfn =</span> <span class="st">&#39;p&#39;</span>, <span class="at">model =</span> <span class="st">&#39;probit&#39;</span>,</span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a>                         <span class="at">optim.method =</span> <span class="st">&#39;BFGS&#39;</span>, <span class="at">sig =</span> .<span class="dv">1</span>, <span class="at">bonferroni =</span> <span class="cn">FALSE</span>,</span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a>                         <span class="at">positive =</span> <span class="cn">TRUE</span>, <span class="at">ideal.setsize =</span> <span class="cn">FALSE</span>, <span class="at">alpha =</span> .<span class="dv">25</span>,</span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a>                         <span class="at">resid.type =</span> <span class="st">&#39;deviance&#39;</span>, <span class="at">boot.MI =</span> <span class="dv">100</span>))</span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a><span class="co">#&gt; 6 out of 31 candidate eigenvectors selected</span></span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a></span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a><span class="co"># ESF poisson model</span></span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a>(poisson.esf <span class="ot">&lt;-</span> <span class="fu">glmFilter</span>(<span class="at">y =</span> y.count, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">W =</span> W, <span class="at">objfn =</span> <span class="st">&#39;BIC&#39;</span>, <span class="at">model =</span> <span class="st">&#39;poisson&#39;</span>,</span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a>                          <span class="at">optim.method =</span> <span class="st">&#39;BFGS&#39;</span>, <span class="at">positive =</span> <span class="cn">TRUE</span>, <span class="at">ideal.setsize =</span> <span class="cn">FALSE</span>,</span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a>                          <span class="at">alpha =</span> .<span class="dv">25</span>, <span class="at">resid.type =</span> <span class="st">&#39;deviance&#39;</span>, <span class="at">boot.MI =</span> <span class="dv">100</span>))</span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a><span class="co">#&gt; 9 out of 31 candidate eigenvectors selected</span></span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a></span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a><span class="co"># ESF negative binomial model</span></span>
<span id="cb11-26"><a href="#cb11-26" tabindex="-1"></a>(poisson.esf <span class="ot">&lt;-</span> <span class="fu">glmFilter</span>(<span class="at">y =</span> y.count, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">W =</span> W, <span class="at">objfn =</span> <span class="st">&#39;BIC&#39;</span>, <span class="at">model =</span> <span class="st">&#39;nb&#39;</span>,</span>
<span id="cb11-27"><a href="#cb11-27" tabindex="-1"></a>                          <span class="at">optim.method =</span> <span class="st">&#39;BFGS&#39;</span>, <span class="at">positive =</span> <span class="cn">TRUE</span>, <span class="at">ideal.setsize =</span> <span class="cn">FALSE</span>,</span>
<span id="cb11-28"><a href="#cb11-28" tabindex="-1"></a>                          <span class="at">alpha =</span> .<span class="dv">25</span>, <span class="at">resid.type =</span> <span class="st">&#39;deviance&#39;</span>, <span class="at">boot.MI =</span> <span class="dv">100</span>))</span>
<span id="cb11-29"><a href="#cb11-29" tabindex="-1"></a><span class="co">#&gt; For negative binomial models, only &#39;raw&#39; and &#39;pearson&#39; residuals currently available. Set to &#39;pearson&#39;</span></span>
<span id="cb11-30"><a href="#cb11-30" tabindex="-1"></a><span class="co">#&gt; 0 out of 31 candidate eigenvectors selected</span></span></code></pre></div>
<p>spfilteR_vignette.R</p>
<p>Again, if users wish to define individual selection criteria or fit a
GLM currently not implemented in <code>glmFilter()</code>, they can
obtain the eigenvectors using the <code>getEVs()</code> command and
perform supervised eigenvector selection using the standard <a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/glm"><code>stats::glm()</code></a>
function.</p>
</div>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="unnumbered">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-cliff1972" class="csl-entry">
Cliff, Andrew D, and John K. Ord. 1972. <span>“Testing for Spatial
Autocorrelation Among Regression Residuals.”</span> <em>Geographical
Analysis</em> 4 (3): 267–84. <a href="https://doi.org/10.1111/j.1538-4632.1972.tb00475.x">https://doi.org/10.1111/j.1538-4632.1972.tb00475.x</a>.
</div>
<div id="ref-cliff1981" class="csl-entry">
———. 1981. <em>Spatial Processes: Models &amp; Applications</em>.
Advances in Spatial Science. London: Pion.
</div>
<div id="ref-dary2011" class="csl-entry">
Dray, Stéphane. 2011. <span>“A New Perspective about Moran’s
Coefficient: Spatial Autocorrelation as a Linear Regression
Problem.”</span> <em>Geographical Analysis</em> 43 (2): 127–41. <a href="https://doi.org/10.1111/j.1538-4632.2011.00811.x">https://doi.org/10.1111/j.1538-4632.2011.00811.x</a>.
</div>
<div id="ref-griffith2003" class="csl-entry">
Griffith, Daniel A. 2003. <em>Spatial Autocorrelation and Spatial
Filtering: Gaining Understanding Through Theory and Scientific
Visualization</em>. Advances in Spatial Science. Berlin, Heidelberg:
Springer. <a href="https://doi.org/10.1007/978-3-540-24806-4">https://doi.org/10.1007/978-3-540-24806-4</a>.
</div>
<div id="ref-griffith2019" class="csl-entry">
Griffith, Daniel A., Yongwan Chun, and Bin Li. 2019. <em>Spatial
Regression Analysis Using Eigenvector Spatial Filtering</em>. Spatial
Econometrics and Spatial Statistics. London: Elsevier. <a href="https://doi.org/10.1016/B978-0-12-815043-6.09990-0">https://doi.org/10.1016/B978-0-12-815043-6.09990-0</a>.
</div>
<div id="ref-tiefelsdorf2007" class="csl-entry">
Tiefelsdorf, Michael, and Daniel A Griffith. 2007. <span>“Semiparametric
Filtering of Spatial Autocorrelation: The Eigenvector Approach.”</span>
<em>Environment and Planning A: Economy and Space</em> 39 (5):
1193–1221. <a href="https://doi.org/10.1068/a37378">https://doi.org/10.1068/a37378</a>.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
